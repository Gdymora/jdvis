<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Library</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@ckeditor/ckeditor5-build-classic@latest/build/ckeditor.js"></script>
    <script src="./data/moderndom-ckeditor-plugin.js"></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <button class="btn btn-primary m20" id="first">Fade out first text</button>
      <button class="btn btn-dark m20" data-count="second">Fade out second text</button>
      <button class="btn btn-warning m20">Fade out all texts</button>

      <div class="icon-wrapper">
        <button class="btn btn-primary m20">click</button>
        <span class="badge" id="elementContainer">450</span>
      </div>

      <!-- Dropdown menu -->
      <div class="dropdown">
        <button class="btn btn-primary dropdown-toggle" id="dropdownMenuButton">Dropdown button</button>
        <div class="dropdown-menu" data-toggle-id="dropdownMenuButton">
          <a href="#" class="dropdown-item">Action</a>
          <a href="#" class="dropdown-item">Action #2</a>
          <a href="#" class="dropdown-item">Action #3</a>
        </div>
      </div>

      <!-- Dropdown menu -->
      <div class="dropdown">
        <button class="btn btn-primary dropdown-toggle" id="dropdownMenuButtonSecond">Dropdown button</button>
        <div class="dropdown-menu" data-toggle-id="dropdownMenuButtonSecond">
          <a href="#" class="dropdown-item">Action Second</a>
          <a href="#" class="dropdown-item">Action #2 Second</a>
          <a href="#" class="dropdown-item">Action #3 Second</a>
        </div>
      </div>

      <!-- Card -->

      <div class="goods d-flex f-space-around">
        <div class="card">
          <img
            class="card-img"
            src="https://www.apple.com/newsroom/images/product/iphone/lifestyle/Apple_Shot-on-iPhone-Challenge-2020_Austin-Mann_01072020_big.jpg.large.jpg"
            alt="photo"
          />
          <div class="card-body">
            <div class="card-title">Card title</div>
            <p class="card-text">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia itaque placeat qui suscipit.</p>
            <a href="#" id="trigger" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Link to</a>
          </div>
        </div>
        <div class="card">
          <img
            class="card-img"
            src="https://www.apple.com/newsroom/images/product/iphone/lifestyle/Apple_Shot-on-iPhone-Challenge-2020_Austin-Mann_01072020_big.jpg.large.jpg"
            alt="photo"
          />
          <div class="card-body">
            <div class="card-title">Card title #2</div>
            <p class="card-text">Lorem ipsum dolor sit amet consectetur adipisicing elit. Officia itaque placeat qui suscipit.</p>
            <a href="#" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal2">Link to</a>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal" id="exampleModal">
        <div class="modal-dialog">
          <div class="modal-content">
            <button class="close" data-close>
              <span>&times;</span>
            </button>
            <div class="modal-header">
              <div class="modal-title">Modal title</div>
            </div>
            <div class="modal-body">
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Harum minus doloremque nesciunt enim rem quam corporis? Dolorem pariatur magnam
              distinctio perferendis. Ratione dolorem voluptates iusto facilis odit veritatis, suscipit voluptatibus!
            </div>
            <div class="modal-footer">
              <button class="btn btn-danger" data-close>Close</button>
              <button class="btn btn-success">Save changes</button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal" id="exampleModal2">
        <div class="modal-dialog">
          <div class="modal-content">
            <button class="close" data-close>
              <span>&times;</span>
            </button>
            <div class="modal-header">
              <div class="modal-title">Modal title #2</div>
            </div>
            <div class="modal-body">Lorem ipsum dolor sit</div>
            <div class="modal-footer">
              <button class="btn btn-danger" data-close>Close</button>
              <button class="btn btn-success">Save changes</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Tabs -->

      <div class="tab mt-20 block-center">
        <div class="tab-panel" data-tabpanel>
          <div class="tab-item tab-item--active">Content 1</div>
          <div class="tab-item">Content 2</div>
          <div class="tab-item">Content 3</div>
        </div>
        <div class="tab-content tab-content--active">
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quaerat laboriosam blanditiis omnis? Ab molestias tempora beatae ex itaque cumque, velit
          modi, molestiae debitis earum dolor quae quis. Ipsum, omnis voluptatem!
          <br />
          <br />
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Amet voluptates ipsum delectus vitae similique earum veniam? Odit soluta quibusdam
          laudantium molestias perferendis ad voluptates, earum ea deserunt architecto provident ipsum.
        </div>
        <div class="tab-content">
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quaerat laboriosam blanditiis omnis? Ab molestias tempora beatae ex itaque cumque, velit
          modi, molestiae debitis earum dolor quae quis. Ipsum, omnis voluptatem!
          <br />
          <br />
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Amet voluptates ipsum delectus vitae similique earum veniam? Odit soluta quibusdam
          laudantium molestias perferendis ad voluptates, earum ea deserunt architecto provident ipsum.
          <br />
          <br />
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Amet voluptates ipsum delectus vitae similique earum veniam? Odit soluta quibusdam
          laudantium molestias perferendis ad voluptates, earum ea deserunt architecto provident ipsum.
        </div>
        <div class="tab-content">
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quaerat laboriosam blanditiis omnis? Ab molestias tempora beatae ex itaque cumque, velit
          modi, molestiae debitis earum dolor quae quis. Ipsum, omnis voluptatem!
        </div>
      </div>

      <div class="tab mt-20 block-center">
        <div class="tab-panel" data-tabpanel>
          <div class="tab-item tab-item--active">Content 1</div>
          <div class="tab-item">Content 2</div>
          <div class="tab-item">Content 3</div>
        </div>
        <div class="tab-content tab-content--active">
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quaerat laboriosam blanditiis omnis? Ab molestias tempora beatae ex itaque cumque, velit
          modi, molestiae debitis earum dolor quae quis. Ipsum, omnis voluptatem!
          <br />
          <br />
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Amet voluptates ipsum delectus vitae similique earum veniam? Odit soluta quibusdam
          laudantium molestias perferendis ad voluptates, earum ea deserunt architecto provident ipsum.
        </div>
        <div class="tab-content">
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quaerat laboriosam blanditiis omnis? Ab molestias tempora beatae ex itaque cumque, velit
          modi, molestiae debitis earum dolor quae quis. Ipsum, omnis voluptatem!
          <br />
          <br />
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Amet voluptates ipsum delectus vitae similique earum veniam? Odit soluta quibusdam
          laudantium molestias perferendis ad voluptates, earum ea deserunt architecto provident ipsum.
          <br />
          <br />
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Amet voluptates ipsum delectus vitae similique earum veniam? Odit soluta quibusdam
          laudantium molestias perferendis ad voluptates, earum ea deserunt architecto provident ipsum.
        </div>
        <div class="tab-content">
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quaerat laboriosam blanditiis omnis? Ab molestias tempora beatae ex itaque cumque, velit
          modi, molestiae debitis earum dolor quae quis. Ipsum, omnis voluptatem!
        </div>
      </div>
      <!-- Accordion -->

      <div class="accordion mt-20 block-center">
        <div class="accordion-head">
          <span>Collapse first element</span>
        </div>
        <div class="accordion-content">
          <div class="accordion-inner">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Autem voluptatibus fuga est cupiditate debitis harum repudiandae modi quia. Enim nobis
            recusandae totam error veniam quod consequatur nulla, debitis mollitia laborum!
          </div>
        </div>
        <div class="accordion-head">
          <span>Collapse second element</span>
        </div>
        <div class="accordion-content">
          <div class="accordion-inner">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Autem voluptatibus fuga est cupiditate debitis harum repudiandae modi quia. Enim nobis
            recusandae totam error veniam quod consequatur nulla, debitis mollitia laborum!
          </div>
        </div>
      </div>

      <div class="carousel" id="example">
        <ol class="carousel-indicators">
          <li class="active" data-slide-to="0"></li>
          <li data-slide-to="1"></li>
          <li data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
          <div class="carousel-slides">
            <div class="carousel-item">
              <img src="https://ipiccy.com/res/template/img/hp_v2/pics/ba-01s3.jpg" alt="photo" />
            </div>
            <div class="carousel-item">
              <img src="https://images.pexels.com/photos/1363876/pexels-photo-1363876.jpeg?cs=srgb&dl=calm-body-of-water-1363876.jpg&fm=jpg" alt="photo" />
            </div>
            <div class="carousel-item">
              <img src="https://pixlr.com/images/best-photo-editor-cover.jpg" alt="photo" />
            </div>
          </div>
        </div>
        <a href="#" class="carousel-prev" data-slide="prev">
          <span class="carousel-prev-icon">&lt;</span>
        </a>
        <a href="#" class="carousel-next" data-slide="next">
          <span class="carousel-next-icon">&gt;</span>
        </a>
      </div>

      <div class="goods d-flex f-space-around" id="cardContainer"></div>

      <div class="container mx-auto flex flex-wrap py-6">
        <!-- Posts Section -->
        <section id="postsContainer" class="w-full md:w-2/3 flex flex-col items-center px-3">
          <!-- Posts will be loaded here -->
        </section>
      </div>

      <!-- Pagination -->
      <div id="pagination" class="flex items-center py-8">
        <!-- Pagination will be generated here -->
      </div>

      <footer class="w-full border-t bg-white pb-12">
        <div id="footerCarousel" class="relative w-full flex items-center invisible md:visible md:pb-12">
          <button id="prev" class="absolute z-10 left-0 bg-blue-800 hover:bg-blue-700 text-white text-2xl font-bold hover:shadow rounded-full w-16 h-16 ml-12">
            ←
          </button>
          <div class="flex transition-transform duration-300 ease-in-out">
            <img src="https://cdn.pixabay.com/photo/2024/06/21/15/56/nature-8844604_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2023/09/14/08/30/agriculture-8252527_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2022/05/19/01/34/bird-7206444_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2023/11/14/20/08/woman-8388428_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2023/05/23/15/42/bengal-tiger-8013012_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2023/10/03/09/59/port-8291059_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2024/04/03/19/49/lake-8673730_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2024/07/24/12/59/bird-8918121_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2013/02/17/07/19/flower-82437_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2024/06/21/15/56/nature-8844604_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2023/09/14/08/30/agriculture-8252527_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2022/05/19/01/34/bird-7206444_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2023/11/14/20/08/woman-8388428_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2023/05/23/15/42/bengal-tiger-8013012_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2023/10/03/09/59/port-8291059_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2024/04/03/19/49/lake-8673730_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2024/07/24/12/59/bird-8918121_1280.jpg" class="w-1/6 hover:opacity-75" />
            <img src="https://cdn.pixabay.com/photo/2013/02/17/07/19/flower-82437_1280.jpg" class="w-1/6 hover:opacity-75" />
            <!-- ... інші зображення ... -->
          </div>
          <button id="next" class="absolute z-10 right-0 bg-blue-800 hover:bg-blue-700 text-white text-2xl font-bold hover:shadow rounded-full w-16 h-16 mr-12">
            →
          </button>
        </div>
        <div class="w-full container mx-auto flex flex-col items-center">
          <div class="flex flex-col md:flex-row text-center md:text-left md:justify-between py-6">
            <a href="#" class="uppercase px-3">About Us</a>
            <a href="#" class="uppercase px-3">Privacy Policy</a>
            <a href="#" class="uppercase px-3">Terms &amp; Conditions</a>
            <a href="#" class="uppercase px-3">Contact Us</a>
          </div>
          <div class="uppercase pb-6">© myblog.com</div>
        </div>
      </footer>
      <div id="adminPanelContainer"></div>
      <script src="script.js"></script>

      <script>
        // $("#cardContainer").cardGeneratorLocal("data/cards.json", true);
        $("#cardContainer").cardGenerator("http://127.0.0.1:8005/api/data-tables/view/1");
      </script>

      <script>
        $("#pagination").pagination(5, 1); // Припустимо, що у нас 5 сторінок, і ми на першій
        $("#footerCarousel").carouselBlog();
        // Використовуємо локальні JSON файли для тестування
        // $("#postsContainer").loadPostsLocal("data/posts.json", true);
        $("#postsContainer").postGenerator("http://127.0.0.1:8005/api/data-tables/view/2");
      </script>
      <script>
        function createCustomUserManagement() {
          return {
            load: function (contentArea, projectId, userService, options = {}) {
              const { page = 1, itemsPerPage = 10, helpers } = options;
              contentArea.html(`
                          <h2 class="text-xl mb-4">Custom User Management</h2>
                          <p>This is a custom implementation of user management.</p>
                          <button id="loadUsersBtn" class="px-4 py-2 bg-blue-500 text-white rounded">Load Users</button>
                          <div id="userList"></div>
                        `);

              $("#loadUsersBtn").on("click", () => {
                userService
                  .getAll(projectId)
                  .then((response) => {
                    const users = response.data;
                    let userListHtml = "<ul>";
                    users.forEach((user) => {
                      userListHtml += `<li>${user.name} (${user.email}) - Custom View</li>`;
                    });
                    userListHtml += "</ul>";
                    $("#userList").html(userListHtml);
                  })
                  .catch((error) => {
                    console.error("Error loading users:", error);
                    $("#userList").html("<p>Error loading users</p>");
                  });
              });
            },

            create: function (userData) {
              console.log("Creating user with custom logic:", userData);
              // Тут може бути ваша кастомна логіка створення користувача
            },

            update: function (userId, userData) {
              console.log("Updating user with custom logic:", userId, userData);
              // Тут може бути ваша кастомна логіка оновлення користувача
            },

            delete: function (userId) {
              console.log("Deleting user with custom logic:", userId);
              // Тут може бути ваша кастомна логіка видалення користувача
            },
          };
        }

        function createCustomComponent() {
          return {
            load: function (contentArea, projectId, customService, options = {}) {
              const { page = 1, itemsPerPage = 10, helpers } = options;

              // Створення базової структури
              const componentHtml = `
        <div class="custom-component">
          <h2 class="text-xl mb-4">Custom Component</h2>
          <div class="tab mt-20 block-center">
            <div class="tab-panel" data-tabpanel>
              <div class="tab-item tab-item--active">Data</div>
              <div class="tab-item">Settings</div>
              <div class="tab-item">Info</div>
            </div>
            <div class="tab-content tab-content--active" id="dataTab"></div>
            <div class="tab-content" id="settingsTab">Settings content here</div>
            <div class="tab-content" id="infoTab">Info content here</div>
          </div>
          <button id="openModalBtn" class="btn btn-primary mt-4">Open Modal</button>
        </div>
      `;
              contentArea.html(componentHtml);

              // Ініціалізація табів
              if (typeof $().tab === "function") {
                $("[data-tabpanel]").tab();
              } else {
                console.error("Tab initialization function is not available");
              }

              // Створення модального вікна
              const modalHtml = `
        <div class="modal" id="customModal">
          <div class="modal-dialog">
            <div class="modal-content">
              <button class="close" data-close>
                <span>&times;</span>
              </button>
              <div class="modal-header">
                <div class="modal-title">Custom Modal</div>
              </div>
              <div class="modal-body">
                This is the content of the custom modal.
              </div>
              <div class="modal-footer">
                <button class="btn btn-danger" data-close>Close</button>
                <button class="btn btn-success" id="saveModalBtn">Save changes</button>
              </div>
            </div>
          </div>
        </div>
      `;
              $("body").append(modalHtml);

              // Ініціалізація модального вікна
              if (typeof $().modal === "function") {
                const modal = $("#customModal").modal();
                $("#openModalBtn").on("click", () => modal.open());
                $("#saveModalBtn").on("click", () => {
                  console.log("Save action");
                  modal.close();
                });
              } else {
                console.error("Modal initialization function is not available");
              }

              // Завантаження даних з використанням customService
              customService
                .getAll(projectId, { page, itemsPerPage })
                .then((data) => {
                  const dataHtml = `
            <h3 class="text-lg mb-2">Custom Data</h3>
            <pre>${JSON.stringify(data, null, 2)}</pre>
          `;
                  $("#dataTab").html(dataHtml);
                })
                .catch((error) => {
                  console.error("Error loading custom data:", error);
                  $("#dataTab").html("<p>Error loading data</p>");
                });
            },
          };
        }
        const customService = {
          baseUrl: "http://127.0.0.1:8005/api/v1",
          getAll: async function (projectId, options = {}) {
            const { page = 1, itemsPerPage = 15 } = options;
            try {
              if (!projectId) {
                throw new Error("Project ID is required");
              }
              const tokenKey = "project_user_token"; // Замініть на реальний ключ або передайте його через параметр
              const token = localStorage.getItem(tokenKey);
              if (!token) {
                throw new Error("Authorization token is missing");
              }
              const response = await fetch(`${this.baseUrl}/project-roles?page=${page}&per_page=${itemsPerPage}`, {
                headers: {
                  Authorization: `Bearer ${token}`,
                  "X-Project-ID": projectId,
                },
              });
              if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
              }
              return await response.json();
            } catch (error) {
              console.error("Error fetching roles:", error);
              throw error;
            }
          },
        };

        $("#adminPanelContainer").html("<p>Hello</p>");
        // Спочатку налаштуємо глобальні параметри (опціонально)
        // $.adminSettings.apiBaseUrl = "http://127.0.0.1:8005/api";
        // $.adminSettings.defaultItemsPerPage = 15;

        // Ініціалізація адмін-панелі
        $("#adminPanelContainer").adminPanel({
          projectId: "15",
          apiBaseUrl: "http://127.0.0.1:8005/api/v1", // Це перевизначить глобальне налаштування, якщо потрібно
          itemsPerPage: 20, // Це перевизначить глобальне налаштування
          onMenuItemClick: function (menuItem) {
            console.log("Clicked menu item:", menuItem);
            $("#adminPanelContainer").trigger("menuItemClick", { menuItem: menuItem });

            // Тут можна додати додаткову логіку при кліку на пункт меню
          },
          components: {
            // Стандартні компоненти
            // userManagement: userManagementComponent,
            //  roleManagement: roleManagementComponent,
            // ...
          },
          customComponents: {
            // Користувацькі компоненти
            customManagement: createCustomUserManagement(),
            customComponent: createCustomComponent(),
          },
          menuItems: [
            { id: "dashboard", label: "Dashboard" },
            { id: "users", label: "Users" },
            { id: "roles", label: "Roles" },
            { id: "permissions", label: "Permissions" },
            { id: "tables", label: "Tables" },
            { id: "posts", label: "Posts" },
            { id: "settings", label: "Settings" },
            { id: "customManagement", label: "Custom Management" }, // Новий пункт меню для користувацького компонента
            { id: "customComponent", label: "Custom Component" }, // Новий пункт меню для користувацького компонента
          ],
          additionalComponents: {
            tabs: $().tab, // Якщо ви хочете використовувати компонент вкладок
            modal: $().modal, // Якщо ви хочете використовувати модальні вікна
          },
          customServices: {
            customManagementService: customService,
            customComponentService: customService,
            // ... інші сервіси
          },
        });

        $("#adminPanelContainer").on("usersLoaded", function () {
          console.log("Users section loaded");
          // Додаткова логіка після завантаження розділу користувачів
        });

        // Приклад кастомізації форми створення ролі
        $("#adminPanelContainer").on("beforeShowRoleForm", function (event, formHtml) {
          // Модифікуємо HTML форми перед відображенням
          return formHtml + '<div class="mt-4"><label>Custom Field: <input type="text" id="customRoleField"></label></div>';
        });

        $("#adminPanelContainer").on("roleFormSubmit", function (event, roleData) {
          // Додаємо кастомне поле до даних ролі перед відправкою
          roleData.customField = $("#customRoleField").val();
          return roleData;
        });

        // Приклад додавання кастомної сторінки налаштувань
        $("#adminPanelContainer").on("menuItemClick", function (event) {
          if (event.detail.menuItem === "settings") {
            const settingsHtml = `
                       <h2 class="text-xl mb-4">Settings</h2>
                        <form id="settingsForm">
                          <label class="block mb-2">
                             Site Name:
                             <input type="text" id="siteName" class="w-full p-2 border rounded">
                          </label>
                          <label class="block mb-2">
                            Footer Text:
                             <input type="text" id="footerText" class="w-full p-2 border rounded">
                          </label>
                          <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Save Settings</button>
                        </form>
                  `;

            $("#contentArea").html(settingsHtml);

            $("#settingsForm").on("submit", (e) => {
              e.preventDefault();
              const settings = {
                siteName: $("#siteName").val(),
                footerText: $("#footerText").val(),
              };
              console.log("Saving settings:", settings);
              const notification = $().notification({
                position: "top-right",
                duration: 3000,
              });
              // Тут можна додати логіку збереження налаштувань
              notification.show("Settings saved successfully", "success");
            });
          }
        });
      </script>
    </div>
  </body>
</html>
